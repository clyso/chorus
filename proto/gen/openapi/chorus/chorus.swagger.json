{
  "swagger": "2.0",
  "info": {
    "title": "chorus/chorus.proto",
    "version": "version not set"
  },
  "tags": [
    {
      "name": "Chorus"
    },
    {
      "name": "Diff"
    },
    {
      "name": "Policy"
    },
    {
      "name": "Webhook"
    }
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/agents": {
      "get": {
        "summary": "Returns list of registered chorus agents.",
        "operationId": "Chorus_GetAgents",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/chorusGetAgentsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "tags": [
          "Chorus"
        ]
      }
    },
    "/consistency/delete": {
      "put": {
        "operationId": "Diff_DeleteReport",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusConsistencyCheckRequest"
            }
          }
        ],
        "tags": [
          "Diff"
        ]
      }
    },
    "/consistency/list": {
      "get": {
        "operationId": "Diff_List",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/chorusListConsistencyChecksResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "tags": [
          "Diff"
        ]
      }
    },
    "/consistency/report": {
      "get": {
        "operationId": "Diff_GetReport",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/chorusGetConsistencyCheckReportResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "tags": [
          "Diff"
        ]
      }
    },
    "/consistency/report-entries": {
      "get": {
        "operationId": "Diff_GetReportEntries",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/chorusGetConsistencyCheckReportEntriesResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "cursor",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "uint64"
          },
          {
            "name": "pageSize",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "uint64"
          }
        ],
        "tags": [
          "Diff"
        ]
      }
    },
    "/consistency/start": {
      "post": {
        "operationId": "Diff_Start",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusStartConsistencyCheckRequest"
            }
          }
        ],
        "tags": [
          "Diff"
        ]
      }
    },
    "/credentials": {
      "post": {
        "summary": "Sets user credentials for a given storage.",
        "operationId": "Chorus_SetUserCredentials",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusSetUserCredentialsRequest"
            }
          }
        ],
        "tags": [
          "Chorus"
        ]
      }
    },
    "/proxy": {
      "get": {
        "summary": "Returns connection details for proxy s3 endpoint",
        "operationId": "Chorus_GetProxyCredentials",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/chorusGetProxyCredentialsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "tags": [
          "Chorus"
        ]
      }
    },
    "/replication": {
      "post": {
        "summary": "Lists configured replications info.",
        "operationId": "Policy_ListReplications",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/chorusListReplicationsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "description": "Filters replications list.",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusListReplicationsRequest"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/replication/add": {
      "post": {
        "summary": "Configures new bucket-level or user-level replication.",
        "operationId": "Policy_AddReplication",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "description": "Configures new user-level or bucket-level replication.",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusAddReplicationRequest"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/replication/delete": {
      "put": {
        "summary": "Deletes given replication",
        "operationId": "Policy_DeleteReplication",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "description": "Represents user-level and bucket-level replication source and destination\ntargets.\n- User-level replicates all existing and future buckets of the user.\n- Bucket-level  replicates a single bucket.",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusReplicationID"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/replication/get": {
      "post": {
        "summary": "Returns replication info by ID.",
        "operationId": "Policy_GetReplication",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/chorusReplication"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "description": "Represents user-level and bucket-level replication source and destination\ntargets.\n- User-level replicates all existing and future buckets of the user.\n- Bucket-level  replicates a single bucket.",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusReplicationID"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/replication/list-buckets": {
      "post": {
        "summary": "Returns list of buckets available for replication.",
        "operationId": "Policy_AvailableBuckets",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/chorusAvailableBucketsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "description": "Request list of bucket available for replication for given user and from/to\nstorages.",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusAvailableBucketsRequest"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/replication/pause": {
      "put": {
        "summary": "Pauses given replication",
        "operationId": "Policy_PauseReplication",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "description": "Represents user-level and bucket-level replication source and destination\ntargets.\n- User-level replicates all existing and future buckets of the user.\n- Bucket-level  replicates a single bucket.",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusReplicationID"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/replication/resume": {
      "put": {
        "summary": "Resumes given replication",
        "operationId": "Policy_ResumeReplication",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "description": "Represents user-level and bucket-level replication source and destination\ntargets.\n- User-level replicates all existing and future buckets of the user.\n- Bucket-level  replicates a single bucket.",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusReplicationID"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/replication/switch": {
      "post": {
        "summary": "Schedules downtime window to switch source\u003c-\u003edestination replication\ntargets. See SwitchDowntimeOpts for downtime scheduling options.\nCan be edited if downtime window has not started yet.",
        "description": "During downtime window all requests to replication target are blocked on\nchorus proxy. When all replication tasks are processed, chorus can perform\noptional data equality check and complete the switch. On completion, proxy\nunblocks requests to target and routes all requests to destination target.\n\nUnlike zero-downtime switch, downtime switch can perform optional data\nequality check and rollback to source target without data loss.\nRequirements:\n  - replication must exist\n  - replication must be proxy-based (agent replication is not supported)\n  - for bucket-level replication, from/to bucket names must be the same\n  - switch is not started. Use DeleteBucketSwitch in this case.",
        "operationId": "Policy_SwitchWithDowntime",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "description": "Request to configure switch between replication source and destination\nwith downtime window.",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusSwitchDowntimeRequest"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/replication/switch/delete": {
      "post": {
        "summary": "Deletes Switch with following implications:\n!!!Use with caution for ZeroDowntime switch.",
        "description": "- [OK] If switch was in not_started, error, or skipped state, it will not\nbe attempted anymore. Routing will not be affected.\n- If switch was in_progress, it will be aborted:\n     * [OK] For downtime switch, block will be removed and proxy will\n     route all requests to source target, no data will be lost.\n     * [WARN] For ZeroDowntime switch, routing will be reverted back to\n     source target. Meaning that targets may end up in inconsistent state\n     because some writes were already routed to destination target.\n- [OK] If switch was done. Only switch metadata will be removed,\nreplication or routing will not be affected.",
        "operationId": "Policy_DeleteSwitch",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "description": "Represents user-level and bucket-level replication source and destination\ntargets.\n- User-level replicates all existing and future buckets of the user.\n- Bucket-level  replicates a single bucket.",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusReplicationID"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/replication/switch/get": {
      "post": {
        "summary": "Returns Switch status",
        "operationId": "Policy_GetSwitchStatus",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/chorusReplicationSwitch"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "description": "Represents user-level and bucket-level replication source and destination\ntargets.\n- User-level replicates all existing and future buckets of the user.\n- Bucket-level  replicates a single bucket.",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusReplicationID"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/replication/switch/zero-downtime": {
      "post": {
        "summary": "Switches source\u003c-\u003edestination replication targets without downtime.\nZero-downtime switch will take effect immediately on chorus proxy:\n- all writes will be now routed to replication destination\n- all reads will be routed to target with latest data\nWhen all replication tasks will be processed, switch will be completed and\nall reads and writes will be routed to destination target only.",
        "description": "Unlike switch with downtime, zero-downtime switch is not checking bucket\ncontents on completion and cannot be aborted or reverted without risk of\ndata loss.\nRequirements for zero-downtime switch:\n  - replication must exist\n  - replication must be proxy-based (agent replication is not supported)\n  - for bucket-level replication, from/to bucket names must be the same\n  - no existing switch must exist for given replication. Zero downtime\n  switch cannot be updated. Use DeleteBucketSwitch in this case.",
        "operationId": "Policy_SwitchWithZeroDowntime",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusSwitchZeroDowntimeRequest"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/routing": {
      "post": {
        "summary": "Returns configured routing policies for chorus proxy.",
        "operationId": "Policy_ListRoutings",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/chorusRoutingsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusRoutingsRequest"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/routing/add": {
      "post": {
        "summary": "Overrides routing destination for given user or user's bucket.",
        "operationId": "Policy_AddRouting",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusAddRoutingRequest"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/routing/block": {
      "put": {
        "summary": "Blocks requests on proxy for given user or user's bucket.",
        "operationId": "Policy_BlockRouting",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusRoutingID"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/routing/delete": {
      "put": {
        "summary": "Removes user or bucket routing override.",
        "operationId": "Policy_DeleteRouting",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusRoutingID"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/routing/unblock": {
      "put": {
        "summary": "Removes block on requests on proxy for given user or user's bucket.",
        "operationId": "Policy_UnblockRouting",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusRoutingID"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/storage": {
      "get": {
        "summary": "Lists configured storages with users",
        "operationId": "Chorus_GetStorages",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/chorusGetStoragesResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "tags": [
          "Chorus"
        ]
      }
    },
    "/test-proxy": {
      "post": {
        "summary": "Returns configured routing and replication for given storage request to\nproxy. Emulates proxy behaviour for given user and bucket.",
        "operationId": "Policy_TestProxy",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/chorusTestProxyResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/chorusTestProxyRequest"
            }
          }
        ],
        "tags": [
          "Policy"
        ]
      }
    },
    "/version": {
      "get": {
        "summary": "Get app version",
        "operationId": "Chorus_GetAppVersion",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/chorusGetAppVersionResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "tags": [
          "Chorus"
        ]
      }
    },
    "/webhook/{storage}/s3-notifications": {
      "post": {
        "summary": "S3Notifications receives standard AWS S3 notification events and enqueues\nreplication tasks. Compatible with S3 bucket notification push format.\nEvents that cannot be processed are skipped and logged server-side.",
        "operationId": "Webhook_S3Notifications",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "storage",
            "description": "Chorus storage alias (must be a configured S3 storage). Bound to URL path.",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/WebhookS3NotificationsBody"
            }
          }
        ],
        "tags": [
          "Webhook"
        ]
      }
    },
    "/webhook/{storage}/swift": {
      "post": {
        "summary": "SwiftEvents receives a batch of OpenStack Swift events parsed from\naccess logs by an external log exporter (e.g. Fluent Bit, Vector)\nand enqueues replication tasks for events matching active policies.\nEvents that cannot be processed are skipped and logged server-side.",
        "operationId": "Webhook_SwiftEvents",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {}
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "storage",
            "description": "Chorus storage alias (must be a configured SWIFT storage).",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/WebhookSwiftEventsBody"
            }
          }
        ],
        "tags": [
          "Webhook"
        ]
      }
    }
  },
  "definitions": {
    "StorageType": {
      "type": "string",
      "enum": [
        "S3",
        "SWIFT"
      ],
      "default": "S3"
    },
    "WebhookS3NotificationsBody": {
      "type": "object",
      "properties": {
        "Records": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/chorusS3EventRecord"
          },
          "description": "Standard AWS S3 notification records.\nEvents are processed independently; a failure in one does not affect others."
        }
      }
    },
    "WebhookSwiftEventsBody": {
      "type": "object",
      "properties": {
        "events": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/chorusSwiftEvent"
          },
          "description": "Events are processed independently; a failure in one does not affect others."
        }
      }
    },
    "chorusAddReplicationRequest": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/chorusReplicationID",
          "description": "REQUIRED: Specifies replication source and destination."
        },
        "opts": {
          "$ref": "#/definitions/chorusReplicationOpts",
          "description": "OPTIONAL: Additional replication options."
        }
      },
      "description": "Configures new user-level or bucket-level replication."
    },
    "chorusAddRoutingRequest": {
      "type": "object",
      "properties": {
        "user": {
          "type": "string",
          "description": "user for whom to override routing destination."
        },
        "bucket": {
          "type": "string",
          "description": "bucket for which to override routing destination."
        },
        "toStorage": {
          "type": "string",
          "title": "destination storage name"
        }
      }
    },
    "chorusAgent": {
      "type": "object",
      "properties": {
        "storage": {
          "type": "string",
          "description": "Storage name from chorus storage config associated with this agent."
        },
        "url": {
          "type": "string",
          "description": "Webhook URL of chorus agent to be used for agent-based replication."
        }
      }
    },
    "chorusAvailableBucketsRequest": {
      "type": "object",
      "properties": {
        "user": {
          "type": "string"
        },
        "fromStorage": {
          "type": "string"
        },
        "toStorage": {
          "type": "string"
        },
        "showReplicated": {
          "type": "boolean"
        }
      },
      "description": "Request list of bucket available for replication for given user and from/to\nstorages."
    },
    "chorusAvailableBucketsResponse": {
      "type": "object",
      "properties": {
        "buckets": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "replicatedBuckets": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "chorusBucketRouting": {
      "type": "object",
      "properties": {
        "user": {
          "type": "string",
          "description": "overrides routing destination for given user and bucket."
        },
        "bucket": {
          "type": "string",
          "description": "overrides routing destination for given user and bucket."
        },
        "toStorage": {
          "type": "string",
          "title": "destination storage name\ncan be empty if routing is blocked"
        },
        "isBlocked": {
          "type": "boolean",
          "title": "true if routing is blocked for given user and bucket"
        }
      }
    },
    "chorusConsistencyCheck": {
      "type": "object",
      "properties": {
        "locations": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/chorusMigrateLocation"
          }
        },
        "queued": {
          "type": "string",
          "format": "uint64"
        },
        "completed": {
          "type": "string",
          "format": "uint64"
        },
        "ready": {
          "type": "boolean"
        },
        "consistent": {
          "type": "boolean"
        },
        "versioned": {
          "type": "boolean"
        },
        "withSize": {
          "type": "boolean"
        },
        "withEtag": {
          "type": "boolean"
        }
      }
    },
    "chorusConsistencyCheckReportEntry": {
      "type": "object",
      "properties": {
        "object": {
          "type": "string"
        },
        "versionIdx": {
          "type": "string",
          "format": "uint64"
        },
        "size": {
          "type": "string",
          "format": "uint64"
        },
        "etag": {
          "type": "string"
        },
        "storageEntries": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/chorusConsistencyCheckStorageEntry"
          }
        }
      }
    },
    "chorusConsistencyCheckRequest": {
      "type": "object",
      "properties": {
        "locations": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/chorusMigrateLocation"
          }
        }
      }
    },
    "chorusConsistencyCheckStorageEntry": {
      "type": "object",
      "properties": {
        "storage": {
          "type": "string"
        },
        "versionId": {
          "type": "string"
        },
        "bucket": {
          "type": "string"
        }
      }
    },
    "chorusCredential": {
      "type": "object",
      "properties": {
        "alias": {
          "type": "string"
        },
        "accessKey": {
          "type": "string"
        },
        "secretKey": {
          "type": "string"
        }
      }
    },
    "chorusEventSource": {
      "type": "string",
      "enum": [
        "EVENT_SOURCE_PROXY",
        "EVENT_SOURCE_S3_NOTIFICATION",
        "EVENT_SOURCE_WEBHOOK"
      ],
      "default": "EVENT_SOURCE_PROXY",
      "description": "Determines how ongoing data change events are captured for replication.\n\n - EVENT_SOURCE_PROXY: Default. Events captured by chorus proxy intercepting S3/Swift API calls.\n - EVENT_SOURCE_S3_NOTIFICATION: S3 bucket notifications. Worker creates SNS topic + bucket notification\npointing to its own webhook endpoint. Bucket-level replication only.\n - EVENT_SOURCE_WEBHOOK: External event source (e.g. Swift access log exporter).\nRequires webhook to be enabled in worker config. No automatic setup."
    },
    "chorusGetAgentsResponse": {
      "type": "object",
      "properties": {
        "agents": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/chorusAgent"
          }
        }
      },
      "description": "List of registered chorus agents."
    },
    "chorusGetAppVersionResponse": {
      "type": "object",
      "properties": {
        "version": {
          "type": "string"
        },
        "commit": {
          "type": "string"
        },
        "date": {
          "type": "string"
        }
      }
    },
    "chorusGetConsistencyCheckReportEntriesResponse": {
      "type": "object",
      "properties": {
        "entries": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/chorusConsistencyCheckReportEntry"
          }
        },
        "cursor": {
          "type": "string",
          "format": "uint64"
        }
      }
    },
    "chorusGetConsistencyCheckReportResponse": {
      "type": "object",
      "properties": {
        "check": {
          "$ref": "#/definitions/chorusConsistencyCheck"
        }
      }
    },
    "chorusGetProxyCredentialsResponse": {
      "type": "object",
      "properties": {
        "address": {
          "type": "string"
        },
        "credentials": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/chorusCredential"
          }
        }
      }
    },
    "chorusGetStoragesResponse": {
      "type": "object",
      "properties": {
        "storages": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/chorusStorage"
          }
        }
      }
    },
    "chorusListConsistencyChecksResponse": {
      "type": "object",
      "properties": {
        "checks": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/chorusConsistencyCheck"
          }
        }
      }
    },
    "chorusListReplicationsRequest": {
      "type": "object",
      "properties": {
        "hideUserReplications": {
          "type": "boolean",
          "description": "if true, user-level replications will be excluded from response."
        },
        "hideBucketReplications": {
          "type": "boolean",
          "description": "if true, bucket-level replications will be excluded from response."
        },
        "hideSwitchInfo": {
          "type": "boolean",
          "description": "if true, replications will be listed without switch info."
        },
        "filter": {
          "$ref": "#/definitions/chorusListReplicationsRequestFilter",
          "description": "OPTIONAL: filter to apply to replications list."
        }
      },
      "description": "Filters replications list."
    },
    "chorusListReplicationsRequestFilter": {
      "type": "object",
      "properties": {
        "user": {
          "type": "string",
          "description": "If set, filters replications by exact user."
        },
        "fromStorage": {
          "type": "string",
          "description": "If set, filters replications by exact source storage."
        },
        "toStorage": {
          "type": "string",
          "description": "If set, filters replications by exact destination storage."
        },
        "fromBucket": {
          "type": "string",
          "description": "If set, filters bucket-level replications by exact source bucket."
        },
        "toBucket": {
          "type": "string",
          "description": "If set, filters bucket-level replications by exact destination bucket."
        },
        "isArchived": {
          "type": "boolean",
          "description": "If set, filters replications by archived status."
        },
        "isPaused": {
          "type": "boolean",
          "description": "If set, filters replications by paused status."
        },
        "isInitDone": {
          "type": "boolean",
          "description": "If set, filters replications by completion of initial replication phase."
        },
        "hasSwitch": {
          "type": "boolean",
          "description": "If set, filters replications that have or not have associated switch."
        },
        "isAgent": {
          "type": "boolean",
          "description": "If set, filters replications by agent-based or proxy-based replication."
        }
      }
    },
    "chorusListReplicationsResponse": {
      "type": "object",
      "properties": {
        "replications": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/chorusReplication"
          }
        }
      }
    },
    "chorusMigrateLocation": {
      "type": "object",
      "properties": {
        "storage": {
          "type": "string"
        },
        "bucket": {
          "type": "string"
        }
      }
    },
    "chorusReplication": {
      "type": "object",
      "properties": {
        "id": {
          "$ref": "#/definitions/chorusReplicationID",
          "description": "Specifies replication source and destination."
        },
        "opts": {
          "$ref": "#/definitions/chorusReplicationOpts",
          "description": "Additional replication options."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "title": "Replication creation time"
        },
        "isPaused": {
          "type": "boolean",
          "title": "true if replication is paused"
        },
        "isInitDone": {
          "type": "boolean",
          "description": "true if initial replication phase is done.\nInitial phase copies all data existing in source at the moment of\nreplication creation."
        },
        "initObjListed": {
          "type": "string",
          "format": "int64",
          "description": "Approximate number of objects listed during initial replication.\nCorresponds to total number of tasks created for initial replication queue."
        },
        "initObjDone": {
          "type": "string",
          "format": "int64",
          "description": "Approximate number of objects processed during initial replication.\nCorresponds to total number of tasks completed from initial replication\nqueue."
        },
        "events": {
          "type": "string",
          "format": "int64",
          "description": "Number of source data change events captured and queued for replication.\nCorresponds to total number of tasks created for event replication queue."
        },
        "eventsDone": {
          "type": "string",
          "format": "int64",
          "description": "Number of source data change events synced to destination.\nCorresponds to total number of tasks completed from event replication\nqueue."
        },
        "eventLag": {
          "type": "string",
          "description": "Approximate time lag for syncing events to destination.\nCorresponds to age of the oldest unprocessed task in event replication\nqueue (aka replication queue latency)."
        },
        "hasSwitch": {
          "type": "boolean"
        },
        "isArchived": {
          "type": "boolean",
          "description": "true if replication is archived. Archived replication will not generate or\nsync new events. The main purpose of archived replication is to keep\nreplication metadata for future reference. Archived replication can be\nsafely deleted."
        },
        "archivedAt": {
          "type": "string",
          "format": "date-time"
        },
        "switchInfo": {
          "$ref": "#/definitions/chorusReplicationSwitch",
          "description": "If replication has associated switch, contains its status info."
        },
        "eventSource": {
          "$ref": "#/definitions/chorusEventSource",
          "description": "How ongoing data change events are captured for this replication."
        },
        "webhookUrl": {
          "type": "string",
          "description": "Webhook endpoint URL for this replication (if event source uses webhook).\nRead-only, computed by the server."
        }
      },
      "description": "Represents specification and status of user-level or bucket-level\nreplication."
    },
    "chorusReplicationID": {
      "type": "object",
      "properties": {
        "user": {
          "type": "string",
          "description": "REQUIRED: Replication user from chorus storage credential config.\nSelected user must be configured for both from/to storages."
        },
        "fromStorage": {
          "type": "string",
          "description": "REQUIRED: source storage name from chorus storage config."
        },
        "toStorage": {
          "type": "string",
          "description": "REQUIRED: destination storage name from chorus storage config.\nCan be equal to from_storage if both from/to buckets are set and different."
        },
        "fromBucket": {
          "type": "string",
          "description": "OPTIONAL: source bucket name.\nFor user-level replication, this field must be empty.\nFor bucket-level replication, this field must be set."
        },
        "toBucket": {
          "type": "string",
          "description": "OPTIONAL: destination bucket name.\nFor user-level replication, this field must be empty.\nFor bucket-level replication, this field must be set. From/to buckets can\nbe different."
        }
      },
      "description": "Represents user-level and bucket-level replication source and destination\ntargets.\n- User-level replicates all existing and future buckets of the user.\n- Bucket-level  replicates a single bucket."
    },
    "chorusReplicationOpts": {
      "type": "object",
      "properties": {
        "eventSource": {
          "$ref": "#/definitions/chorusEventSource",
          "description": "Determines how ongoing data change events are captured."
        }
      },
      "description": "Additional replication options for bucket and user-level replications."
    },
    "chorusReplicationSwitch": {
      "type": "object",
      "properties": {
        "lastStatus": {
          "$ref": "#/definitions/chorusReplicationSwitchStatus",
          "title": "Current switch status"
        },
        "zeroDowntime": {
          "type": "boolean",
          "title": "true if switch is zero downtime"
        },
        "multipartTtl": {
          "type": "string",
          "title": "multipart uploads TTL for zero downtime switch"
        },
        "downtimeOpts": {
          "$ref": "#/definitions/chorusSwitchDowntimeOpts"
        },
        "lastStartedAt": {
          "type": "string",
          "format": "date-time",
          "description": "Time of last switch attempt - last time when switch was moved to InProgress\nstatus."
        },
        "doneAt": {
          "type": "string",
          "format": "date-time",
          "description": "Time of last switch completion. Set only if switch status is Done."
        },
        "history": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "History of switch status changes"
        },
        "replicationId": {
          "$ref": "#/definitions/chorusReplicationID"
        }
      }
    },
    "chorusReplicationSwitchStatus": {
      "type": "string",
      "enum": [
        "NOT_STARTED",
        "IN_PROGRESS",
        "CHECK_IN_PROGRESS",
        "ERROR",
        "SKIPPED",
        "DONE"
      ],
      "default": "NOT_STARTED",
      "description": " - NOT_STARTED: Switch is not started yet\n - IN_PROGRESS: Switch is in progress. Draining replication events queue.\nFor switch with downtime, requests to target are blocked at this point.\n - CHECK_IN_PROGRESS: Switch is in progress. Queue is drained. Checking if source and\ndestination targets are the same. Requests are still blocked. Used only\nfor switch with downtime with enabled bucket check.\n - ERROR: Switch failed to complete in downtime window and was aborted.\nRequests to target are unblocked. Used only for switch with downtime.\nIf cron downtime_window is used, switch will be retried on next cron\nexecution.\n - SKIPPED: Switch was not able to start in given downtime window because conditions\nwere not met. Used only for switch with downtime. If cron downtime_window\nis used, switch will be retried on next cron execution.\n - DONE: Switch was successfully completed.\nAll data was replicated to replication destination target and all read\nand all requests are now routed to it."
    },
    "chorusRoutingID": {
      "type": "object",
      "properties": {
        "user": {
          "type": "string",
          "title": "routing policy user"
        },
        "bucket": {
          "type": "string",
          "title": "routing policy bucket"
        }
      }
    },
    "chorusRoutingsRequest": {
      "type": "object",
      "properties": {
        "hideUserRoutings": {
          "type": "boolean",
          "title": "set true to hide user-level routings from response"
        },
        "hideBucketRoutings": {
          "type": "boolean",
          "title": "set true to hide bucket-level routings from response"
        },
        "filter": {
          "$ref": "#/definitions/chorusRoutingsRequestFilter",
          "title": "optional filter to apply to routings list"
        }
      }
    },
    "chorusRoutingsRequestFilter": {
      "type": "object",
      "properties": {
        "user": {
          "type": "string",
          "title": "filter routing policy by user (exact match)"
        },
        "bucket": {
          "type": "string",
          "title": "filter routing policy by bucket (exact match)"
        },
        "toStorage": {
          "type": "string",
          "title": "filter routing policy by destination storage (exact match)"
        },
        "isBlocked": {
          "type": "boolean",
          "title": "filter routing policy by blocked status"
        }
      }
    },
    "chorusRoutingsResponse": {
      "type": "object",
      "properties": {
        "main": {
          "type": "string",
          "description": "name of the main storage - default destination if not overridden by user or\nbucket routing."
        },
        "userRoutings": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/chorusUserRouting"
          },
          "description": "list of user-level routing overrides."
        },
        "bucketRoutings": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/chorusBucketRouting"
          },
          "description": "list of bucket-level routing overrides."
        }
      }
    },
    "chorusS3BucketInfo": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        }
      }
    },
    "chorusS3Credential": {
      "type": "object",
      "properties": {
        "accessKey": {
          "type": "string"
        },
        "secretKey": {
          "type": "string"
        }
      }
    },
    "chorusS3EventPayload": {
      "type": "object",
      "properties": {
        "configurationId": {
          "type": "string",
          "description": "Encoded chorus notification ID (contains user + bucket)."
        },
        "bucket": {
          "$ref": "#/definitions/chorusS3BucketInfo"
        },
        "object": {
          "$ref": "#/definitions/chorusS3ObjectInfo"
        }
      }
    },
    "chorusS3EventRecord": {
      "type": "object",
      "properties": {
        "eventName": {
          "type": "string",
          "title": "e.g. \"s3:ObjectCreated:Put\", \"s3:ObjectRemoved:Delete\""
        },
        "s3": {
          "$ref": "#/definitions/chorusS3EventPayload"
        }
      }
    },
    "chorusS3ObjectInfo": {
      "type": "object",
      "properties": {
        "key": {
          "type": "string"
        },
        "size": {
          "type": "string",
          "format": "int64"
        },
        "eTag": {
          "type": "string"
        }
      }
    },
    "chorusSetUserCredentialsRequest": {
      "type": "object",
      "properties": {
        "storage": {
          "type": "string"
        },
        "user": {
          "type": "string"
        },
        "s3Cred": {
          "$ref": "#/definitions/chorusS3Credential"
        },
        "swiftCred": {
          "$ref": "#/definitions/chorusSwiftCredential"
        }
      }
    },
    "chorusStartConsistencyCheckRequest": {
      "type": "object",
      "properties": {
        "locations": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/chorusMigrateLocation"
          }
        },
        "user": {
          "type": "string"
        },
        "checkOnlyLastVersions": {
          "type": "boolean"
        },
        "ignoreEtags": {
          "type": "boolean"
        },
        "ignoreSizes": {
          "type": "boolean"
        }
      }
    },
    "chorusStorage": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "title": "some human-readable alias for storage config"
        },
        "isMain": {
          "type": "boolean"
        },
        "address": {
          "type": "string",
          "title": "ex: s3.clyso.com"
        },
        "provider": {
          "$ref": "#/definitions/StorageType"
        },
        "credentials": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/chorusCredential"
          },
          "title": "credentials: access key (public, aka username)"
        }
      }
    },
    "chorusSwiftCredential": {
      "type": "object",
      "properties": {
        "username": {
          "type": "string"
        },
        "password": {
          "type": "string"
        },
        "domainName": {
          "type": "string"
        },
        "tenantName": {
          "type": "string"
        }
      }
    },
    "chorusSwiftEvent": {
      "type": "object",
      "properties": {
        "account": {
          "type": "string",
          "description": "OpenStack project ID (tenant ID). Required."
        },
        "container": {
          "type": "string",
          "description": "Required for container and object operations."
        },
        "object": {
          "type": "string",
          "description": "Required for object operations."
        },
        "operation": {
          "$ref": "#/definitions/chorusSwiftOperation"
        },
        "etag": {
          "type": "string",
          "description": "Optional. Object ETag (MD5)."
        },
        "lastModified": {
          "type": "string",
          "description": "Optional. Object last modified timestamp."
        },
        "versionId": {
          "type": "string",
          "description": "Optional. Object version ID."
        },
        "date": {
          "type": "string",
          "description": "Optional. Server response date, used as reference timestamp when\nSwift does not return Last-Modified (account/container/meta updates)."
        },
        "deleteMultipart": {
          "type": "boolean",
          "description": "Optional. If true, indicates SLO/DLO multipart manifest deletion."
        }
      }
    },
    "chorusSwiftOperation": {
      "type": "string",
      "enum": [
        "SWIFT_OPERATION_UNSPECIFIED",
        "ACCOUNT_UPDATE",
        "CONTAINER_UPDATE",
        "CONTAINER_DELETE",
        "OBJECT_CREATED",
        "OBJECT_METADATA_UPDATED",
        "OBJECT_DELETED"
      ],
      "default": "SWIFT_OPERATION_UNSPECIFIED",
      "description": "SwiftOperation determines which replication task is created.\nTask handlers are idempotent  e.g. CONTAINER_UPDATE and CONTAINER_DELETE\nboth trigger a sync that compares source and destination state."
    },
    "chorusSwitchDowntimeOpts": {
      "type": "object",
      "properties": {
        "startOnInitDone": {
          "type": "boolean",
          "title": "If true, chorus will perform switch automatically when initial migration\nwill be done. Initial migration copies all objects that existed in source\nbucket before replication started. default is false"
        },
        "cron": {
          "type": "string",
          "description": "If set, chorus will try or retry to start downtime window according to CRON\nschedule.\nIt is not makes sense to set cron frequency less than one hour or less than\nmax_duration if used. Either cron or start_at can be set, but not both."
        },
        "startAt": {
          "type": "string",
          "format": "date-time",
          "description": "If set, downtime window will be attempted at given time only once.\nIf at this point initial migration will not be done, switch will be marked\nas failed and not executed. Either cron or start_at can be set, not both."
        },
        "maxDuration": {
          "type": "string",
          "description": "If set, chorus will abort downtime window if it will not be able to\ncomplete in given time. In this case, switch will be marked as failed and\nwill be retried on next cron execution if set."
        },
        "maxEventLag": {
          "type": "integer",
          "format": "int64",
          "description": "If set, switch execution will be skipped if number of unprocessed events is\nmore than max_event_lag. Switch will be marked as failed and will be\nretried on next cron execution if set."
        },
        "skipBucketCheck": {
          "type": "boolean",
          "description": "if true, chorus will not perform equality check of target contents before\ncompleting switch with downtime. Might be useful for buckets with large\nnumber of objects. In this case check will consume a lot of time and memory\nin Redis. Default is false."
        },
        "continueReplication": {
          "type": "boolean",
          "description": "Set true to replicate data updates from new main to old main bucket after\nsuccessful switch. Default is false."
        }
      },
      "description": "Defines downtime window for replication switch with downtime.\nAll dates and times depends on local times of machine running chorus worker.\nTime precision is ~1 minute."
    },
    "chorusSwitchDowntimeRequest": {
      "type": "object",
      "properties": {
        "replicationId": {
          "$ref": "#/definitions/chorusReplicationID",
          "description": "Id of user- or bucket- level replication policy to switch source and\ndestination targets on proxy. Replication policy should already exist.\nAgent-based replication is not supported.\nBucket-level replication with different from/to bucket names is not\nsupported."
        },
        "downtimeOpts": {
          "$ref": "#/definitions/chorusSwitchDowntimeOpts",
          "description": "Configures downtime window for switch. During downtime all requests to\ntarget will be blocked on proxy. If options are not set, downtime will be\nstarted right away and will last until all replication tasks are processed."
        }
      },
      "description": "Request to configure switch between replication source and destination\nwith downtime window."
    },
    "chorusSwitchZeroDowntimeRequest": {
      "type": "object",
      "properties": {
        "replicationId": {
          "$ref": "#/definitions/chorusReplicationID",
          "description": "Id of user- or bucket- level replication policy to switch source and\ndestination targets on proxy. Replication policy should already exist.\nAgent-based replication is not supported.\nBucket-level replication with different from/to bucket names is not\nsupported."
        },
        "multipartTtl": {
          "type": "string",
          "description": "Max Amount of time to wait for uncompleted multipart uploads to finish\nbefore switching targets. Default is 1 hour."
        }
      }
    },
    "chorusTestProxyRequest": {
      "type": "object",
      "properties": {
        "user": {
          "type": "string",
          "title": "user making requests"
        },
        "bucket": {
          "type": "string",
          "title": "bucket being accessed"
        }
      }
    },
    "chorusTestProxyResponse": {
      "type": "object",
      "properties": {
        "routeToStorage": {
          "type": "string",
          "description": "destination storage name according to current routing configuration."
        },
        "isBlocked": {
          "type": "boolean",
          "description": "true if requests are blocked for given user and bucket."
        },
        "replications": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/chorusReplicationID"
          },
          "description": "list of applicable replications for given user and bucket."
        }
      }
    },
    "chorusUserRouting": {
      "type": "object",
      "properties": {
        "user": {
          "type": "string",
          "description": "overrides routing destination for all requests of given user."
        },
        "toStorage": {
          "type": "string",
          "title": "destination storage name\ncan be empty if routing is blocked"
        },
        "isBlocked": {
          "type": "boolean",
          "title": "true if routing is blocked for given user"
        }
      }
    },
    "googlerpcStatus": {
      "type": "object",
      "properties": {
        "code": {
          "type": "integer",
          "format": "int32"
        },
        "message": {
          "type": "string"
        },
        "details": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/protobufAny"
          }
        }
      }
    },
    "protobufAny": {
      "type": "object",
      "properties": {
        "@type": {
          "type": "string"
        }
      },
      "additionalProperties": {}
    }
  }
}
